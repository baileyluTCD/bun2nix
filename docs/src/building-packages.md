# Building Packages

`bun2nix` provides a simple helper derivation builder to help building packages with it's generated `bun.nix` file.

## Building with `mkBunDerivation`

`mkBunDerivation` is provided as a library function to build bun packages from the file generated by the [bun2nix command line tool](./using-the-command-line-tool.md).

Currently, basic usage would look something like:

```nix
{mkBunDerivation, ...}:
mkBunDerivation {
  pname = "simple-bun-app";
  version = "1.0.0";

  src = ./.;

  bunNix = ./bun.nix;

  index = "index.ts";
}
```

The full list of accepted arguments is:

| Argument     | Purpose                                                                                                                                                                                             |
| ------------ | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `pname`      | The name of the package to build                                                                                                                                                                    |
| `version`    | Your package version                                                                                                                                                                                |
| `src`        | The source code for your package                                                                                                                                                                    |
| `bunNix`     | The file generated by the `bun2nix` cli                                                                                                                                                             |
| `index`      | The index.{js,ts} file entry point to your bun application. If you do not have one, leave this empty and use a custom `buildPhase`. This should be a string containing the relative path from `src` |
| `buildFlags` | Optional flags to pass into `bun build` in the default `buildPhase`                                                                                                                                 |

## Building with your own builder function

If you wish to attempt building with your own derivation function, there are some important things you may wish to know:

1. `bun.nix` contains a list of package metadata that has all you need to construct a `node_modules` directory for a given package.
2. This can be produced with the `mkBunNodeModules` library function provided by `bun2nix`.
